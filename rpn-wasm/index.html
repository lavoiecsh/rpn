<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RPN</title>
    <script type="module">
        import init, { WasmStack } from './pkg/rpn_wasm.js';
        await init();

        const stack = new WasmStack();
        let number = undefined;
        
        function push() {
            if (number === undefined) {
                return;
            }
            stack.push(number);
            number = undefined;
        }

        function evaluate(event) {
            if ('0123456789'.includes(event.data)) {
                if (number === undefined) {
                    number = 0;
                }
                number *= 10;
                number += event.data - '0';
                return;
            }
            push();
            stack.evaluate(event.data);
            document.getElementById('input').value = '';
            document.getElementById('output').innerHTML = stack.stack().join('<br/>');
        }

        document.getElementById('input').addEventListener('input', evaluate);
    </script>
</head>
<body>
<label for="input">Expression</label>
<input id="input" type="text">
<div id="output"></div>
</body>
</html>